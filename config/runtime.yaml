# =============================================================================
# Runtime Configuration - 執行時期設定
# =============================================================================

version: "1.0"

# -----------------------------------------------------------------------------
# 執行模式
# -----------------------------------------------------------------------------
execution:
  # 模式: draft / publish
  mode: draft

  # 版本: premarket / postclose / intraday
  edition: postclose

  # 時區
  timezone: "America/New_York"

  # 是否啟用 dry-run (不實際發布)
  dry_run: false

# -----------------------------------------------------------------------------
# 資料收集設定
# -----------------------------------------------------------------------------
collector:
  google_news:
    # 每個查詢抓取的新聞數量
    items_per_query: 10

    # 語言/地區
    language: "en"
    country: "US"

    # 快取 TTL (秒)
    cache_ttl: 600

    # 請求間隔 (秒)
    request_delay: 1.0

# -----------------------------------------------------------------------------
# 資料補完設定
# -----------------------------------------------------------------------------
enricher:
  fmp:
    # 請求超時 (秒)
    timeout: 30

    # 重試次數
    max_retries: 3

    # Rate limit (requests per minute)
    rate_limit_rpm: 300

  alpha_vantage:
    timeout: 30
    max_retries: 3
    rate_limit_rpm: 5  # 免費版限制較嚴

# -----------------------------------------------------------------------------
# 分析器設定
# -----------------------------------------------------------------------------
analyzer:
  event_scoring:
    # 最低可信度閾值 (publisher 數量)
    min_credibility_publishers: 2

    # Rumor 事件降權係數
    rumor_penalty: 0.3

  selection:
    # 主要事件數量
    primary_events: 1

    # 關鍵個股數量
    key_stocks:
      min: 2
      max: 4

# -----------------------------------------------------------------------------
# 估值模型設定
# -----------------------------------------------------------------------------
valuation:
  # 使用的方法
  methods:
    - peer_multiple

  # 情境設定
  scenarios:
    bear:
      percentile: 25
      label: "熊市"
    base:
      percentile: 50
      label: "基準"
    bull:
      percentile: 75
      label: "牛市"

# -----------------------------------------------------------------------------
# 寫稿設定
# -----------------------------------------------------------------------------
writer:
  codex:
    # 模型
    model: "gpt-5.2"

    # 最大 tokens
    max_tokens: 8000

    # Temperature
    temperature: 0.7

# -----------------------------------------------------------------------------
# 發布設定
# -----------------------------------------------------------------------------
publisher:
  ghost:
    # 預設 tags
    default_tags:
      - "Daily Deep Brief"
      - "Research"

    # 是否自動加入 ticker tags
    auto_ticker_tags: true

    # Newsletter 設定
    newsletter:
      enabled: true
      slug: "default-newsletter"

# -----------------------------------------------------------------------------
# LLM Review 設定
# -----------------------------------------------------------------------------
# Stage 3.6: 基礎 LLM Review (cli-gpt-5.2)
llm_review:
  # P0 優化：暫時停用（cli-gpt-5.2 無可用 Codex 容器，全部失敗）
  enabled: false
  max_iterations: 3

# Stage 3.7: 進階 LLM Review (cli-gpt-5.2-high review → cli-gpt-5.2 revision)
chatgpt_review:
  # P0 優化：暫時停用（同上）
  enabled: false
  max_iterations: 1

# -----------------------------------------------------------------------------
# 品質控管設定
# -----------------------------------------------------------------------------
quality:
  # 來源數量下限
  min_sources: 5

  # 數字追溯檢查
  number_traceability: true

  # 禁用詞列表
  forbidden_words:
    - "保證獲利"
    - "穩賺不賠"
    - "guaranteed profit"
    - "guaranteed return"
    - "risk-free"
    - "sure thing"

  # 必須包含的免責聲明
  required_disclosures:
    - "非投資建議"
    - "投資有風險"

# -----------------------------------------------------------------------------
# 監控告警設定
# -----------------------------------------------------------------------------
alerting:
  # 啟用的告警通道
  channels:
    - console
    # - slack
    # - email

  # 告警等級閾值
  level: warning  # debug / info / warning / error

# -----------------------------------------------------------------------------
# 快取設定
# -----------------------------------------------------------------------------
cache:
  # 類型: file / sqlite
  type: sqlite

  # SQLite 路徑
  sqlite_path: "data/cache.db"

  # 檔案快取目錄
  file_path: "data/cache"

  # 預設 TTL (秒)
  default_ttl: 3600
